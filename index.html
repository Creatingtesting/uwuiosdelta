<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Luau Deobfuscator</title>
  <style>
    body { font-family: monospace; background:#111; color:#0f0; padding:20px; }
    textarea { width:100%; height:200px; background:#222; color:#0f0; }
    button { padding:10px; margin-top:10px; background:#333; color:#0f0; border:none; }
  </style>
</head>
<body>
  <h2>Luau Deobfuscator</h2>
  <textarea id="input" placeholder="Paste obfuscated Luau code here..."></textarea>
  <button onclick="deobfuscate()">Deobfuscate</button>
  <textarea id="output" placeholder="Deobfuscated code will appear here..."></textarea>

  <script>
    // Base64 decoder
    function b64decode(str) {
      try { return atob(str); } catch { return str; }
    }

    // ASCII \ddd decoder
    function asciiDecode(str) {
      return str.replace(/\\(\d{1,3})/g, (_,d) => String.fromCharCode(parseInt(d,10)));
    }

    // XOR decoder (basic)
    function xorDecode(str, key=123) {
      return str.split('').map(c => 
        String.fromCharCode(c.charCodeAt(0) ^ key)
      ).join('');
    }

    // Main deobfuscation pipeline
    function deobfuscate() {
      let code = document.getElementById('input').value;

      // Step 1: Decode \ddd ascii
      code = asciiDecode(code);

      // Step 2: Base64 if found
      let b64matches = code.match(/[A-Za-z0-9+/=]{20,}/g);
      if (b64matches) {
        b64matches.forEach(m => {
          let decoded = b64decode(m);
          code = code.replace(m, decoded);
        });
      }

      // Step 3: Try XOR decode (brute with common keys?)
      // Example: run multiple passes with small keys
      for (let k=1; k<5; k++) {
        if (/[\x00-\x1F]/.test(code)) { // if still weird chars
          code = xorDecode(code, k);
        }
      }

      document.getElementById('output').value = code;
    }
  </script>
</body>
</html>
