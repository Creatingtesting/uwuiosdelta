<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luau Code Deobfuscator</title>
    <style>
        body {
            background: linear-gradient(135deg, #1e1e2f, #2a2a4e);
            color: #ffffff;
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: auto;
        }
        .container {
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
            width: 700px;
            max-width: 90%;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        h1 {
            font-size: 2em;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #00ffff;
        }
        textarea {
            width: 100%;
            height: 150px;
            background: #2e2e4e;
            border: 1px solid #00ffff;
            border-radius: 10px;
            color: #ffffff;
            padding: 10px;
            font-family: 'Courier New', monospace;
            resize: none;
            box-sizing: border-box;
        }
        .buttons {
            margin: 20px 0;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .toggles {
            margin: 10px 0;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 20px;
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            border: none;
            border-radius: 5px;
            color: #ffffff;
            font-size: 1em;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin: 5px;
        }
        button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }
        label {
            margin: 5px;
            font-size: 0.9em;
        }
        #output {
            background: #1e1e2f;
            border: 1px solid #ff00ff;
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-x: auto;
            overflow-y: auto;
            text-align: left;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            box-sizing: border-box;
        }
        #output-type {
            font-size: 0.9em;
            color: #00ffff;
            margin-bottom: 10px;
        }
        .glow {
            animation: glow 1.5s ease-in-out infinite alternate;
        }
        @keyframes glow {
            from {
                box-shadow: 0 0 10px #00ffff;
            }
            to {
                box-shadow: 0 0 20px #ff00ff;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="glow">Luau Code Deobfuscator</h1>
        <textarea id="inputCode" placeholder="Enter your obfuscated Luau code here..."></textarea>
        <div class="toggles">
            <label><input type="checkbox" id="antiTamper"> Anti Tamper</label>
            <label><input type="checkbox" id="maxProtection"> Maximum Protection</label>
            <label><input type="checkbox" id="24Protection"> 24/7 Protection</label>
            <label><input type="checkbox" id="over5kb"> Over 5KB Size</label>
            <label><input type="checkbox" id="numObf"> Number Deobfuscation</label>
            <label><input type="checkbox" id="strSplit"> String DeSplitting</label>
            <label><input type="checkbox" id="hideSource"> Hide Source</label>
            <label><input type="checkbox" id="minify"> Minify Output</label>
            <label><input type="checkbox" id="deadCode"> Remove Dead Code</label>
            <label><input type="checkbox" id="antiDump"> Anti Dump</label>
        </div>
        <div class="buttons">
            <button onclick="deobfuscate('base64')">DeBase64 Strings</button>
            <button onclick="deobfuscate('xor')">DeXOR Strings</button>
            <button onclick="deobfuscate('rename')">DeVariable Renaming</button>
            <button onclick="deobfuscate('control')">DeControl Flow</button>
            <button onclick="deobfuscate('max')">Deobfuscate Using Everything</button>
            <button onclick="copyCode()">Copy Code</button>
        </div>
        <h2>Deobfuscated Code</h2>
        <div id="output-type">Select a deobfuscation method...</div>
        <div id="output">Deobfuscated code will appear here...</div>
    </div>

    <script>
        const defaultCode = `local player = game.Players.LocalPlayer
local function greet(name)
    print("Hello, " .. name .. "!")
end
greet(player.Name)
for i = 1, 5 do
    print("Count: " .. i)
end`;

        function jsB4decode(str, tbl) {
            let r = [];
            let t = [];
            for (let i = 0; i < str.length; i++) {
                let c = str[i];
                if (c !== '=') {
                    let v = tbl.indexOf(c);
                    if (v !== -1) {
                        t.push(v);
                    } else {
                        return "";
                    }
                }
            }
            for (let i = 0; i < t.length; i += 4) {
                let v1 = t[i] || 0;
                let v2 = t[i+1] || 0;
                let v3 = t[i+2] || 0;
                let v4 = t[i+3] || 0;
                let a = (v1 * 4 + (v2 >> 4)) >> 0;
                let b = (((v2 & 15) * 16) + (v3 >> 2)) >> 0;
                let c = (((v3 & 3) * 64) + v4) >> 0;
                r.push(String.fromCharCode(a));
                if (t[i+2] != undefined) r.push(String.fromCharCode(b));
                if (t[i+3] != undefined) r.push(String.fromCharCode(c));
            }
            return r.join('');
        }

        function jsXorDecode(str, keys) {
            let result = [];
            let keyLen = keys.length;
            for (let i = 0; i < str.length; i++) {
                let char = str.charCodeAt(i);
                let key = keys[i % keyLen];
                result.push(String.fromCharCode(char ^ key));
            }
            return result.join('');
        }

        function deobfuscate(type) {
            try {
                let code = document.getElementById('inputCode').value || defaultCode;
                let temp = removeComments(code);
                const minify = document.getElementById('minify').checked;
                const antiDump = document.getElementById('antiDump').checked;
                const deadCode = document.getElementById('deadCode').checked;
                const numObf = document.getElementById('numObf').checked;
                const strSplit = document.getElementById('strSplit').checked;

                let outputType = '';

                if (type === 'base64' || type === 'max') {
                    let oldTemp;
                    do {
                        oldTemp = temp;
                        temp = temp.replace(/b64decode\("([^"]*)",\ "([^"]*)"\)/g, (match, str, tbl) => `"${jsB4decode(str, tbl)}"`);
                    } while (oldTemp !== temp);
                    outputType = type === 'base64' ? 'DeBase64 Strings' : outputType;
                }

                if (type === 'xor' || type === 'max') {
                    let oldTemp;
                    do {
                        oldTemp = temp;
                        temp = temp.replace(/xorDecode\("([^"]*)",\ \[(.*?)\]\)/g, (match, str, keysStr) => {
                            const keys = keysStr.split(', ').map(Number);
                            const decoded = jsXorDecode(str, keys);
                            return `"${decoded}"`;
                        });
                    } while (oldTemp !== temp);
                    outputType = type === 'xor' ? 'DeXOR Strings' : outputType;
                }

                if (type === 'rename' || type === 'max') {
                    let identifierMap = new Map();
                    let variableCounter = 1;
                    temp = temp.replace(/\b(local\s+|function\s+)(\w+)/g, (match, prefix, id) => {
                        if (!identifierMap.has(id)) {
                            identifierMap.set(id, `v${variableCounter++}`);
                        }
                        return `${prefix}${identifierMap.get(id)}`;
                    });
                    temp = temp.replace(/\b(\w+)\b/g, (match, id) => {
                        if (identifierMap.has(id)) return identifierMap.get(id);
                        return id;
                    });
                    outputType = type === 'rename' ? 'DeVariable Renaming' : outputType;
                }

                if (type === 'control' || type === 'max') {
                    temp = temp.replace(/if false then[\s\S]*?end/g, '');
                    temp = temp.replace(/if nil then[\s\S]*?end/g, '');
                    temp = temp.replace(/for\s+\w+\s*=\s*1\s*,\s*0\s*do[\s\S]*?end/g, '');
                    temp = temp.replace(/local \w+ = nil; if \w+ then[\s\S]*?end/g, '');
                    outputType = type === 'control' ? 'DeControl Flow' : outputType;
                }

                if (numObf || type === 'max') {
                    let oldTemp;
                    do {
                        oldTemp = temp;
                        temp = temp.replace(/\(\s*(\d+)\s*\+\s*(\d+)\s*\)/g, (m, a, b) => Number(a) + Number(b));
                        temp = temp.replace(/\(\s*(\d+)\s*\-\s*(\d+)\s*\)/g, (m, a, b) => Number(a) - Number(b));
                        temp = temp.replace(/\(\s*(\d+)\s*\*\s*(\d+)\s*\)/g, (m, a, b) => Number(a) * Number(b));
                        temp = temp.replace(/\(\s*(\d+)\s*\/\s*(\d+)\s*\)/g, (m, a, b) => Number(a) / Number(b));
                    } while (oldTemp !== temp);
                }

                if (strSplit || type === 'max') {
                    let oldTemp;
                    do {
                        oldTemp = temp;
                        temp = temp.replace(/(".*?")\s*\.\.\s*(".*?")/g, (m, a, b) => a.slice(0, -1) + b.slice(1));
                    } while (oldTemp !== temp);
                }

                if (deadCode || type === 'max') {
                    temp = temp.replace(/if false then[\s\S]*?end/g, '');
                    temp = temp.replace(/local \w+ = function\(\) return end; \w+\(\)/g, '');
                    temp = temp.replace(/if nil then[\s\S]*?end/g, '');
                    temp = temp.replace(/local \w+ = math.random\(\) > 2 and true or false; if \w+ then end/g, '');
                }

                if (antiDump) {
                    const unicodeJunk = `${String.fromCharCode(8232, 8233, 8203, 8204, 8205, 8298, 8299, 8300, 65279, 200B, 200C, 200D, 202A, 202B, 202C, 202D, 202E)}`;
                    const lines = temp.split('\n');
                    let newLines = [];
                    for (let line of lines) {
                        newLines.push(unicodeJunk + line);
                        if (Math.random() > 0.8) {
                            newLines.push(unicodeJunk.repeat(Math.floor(Math.random() * 5 + 1)));
                        }
                    }
                    temp = newLines.join('\n');
                }

                if (type === 'max') {
                    outputType = 'Deobfuscate Using Everything';
                }

                if (minify) {
                    temp = minifyCode(temp);
                }

                document.getElementById('output-type').textContent = `Deobfuscation Type: ${outputType}`;
                document.getElementById('output').textContent = temp || 'Error: No output generated';
            } catch (err) {
                console.error(err);
                document.getElementById('output').textContent = 'Error during deobfuscation: ' + err.message;
            }
        }

        function copyCode() {
            const output = document.getElementById('output').textContent;
            if (output && output !== 'Deobfuscated code will appear here...') {
                navigator.clipboard.writeText(output).then(() => {
                    alert('Code copied to clipboard!');
                }).catch(err => {
                    alert('Failed to copy: ' + err);
                });
            } else {
                alert('No code to copy!');
            }
        }

        function randomString(length) {
            const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_';
            let result = '_';
            for (let i = 0; i < length - 1; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
    </script>
</body>
</html>
